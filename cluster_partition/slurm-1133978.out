cuda-12.1 loaded successful
gcc-11.3.0 loaded successful
===== PARTITION INTEGRATED PIPELINE STARTED =====
>>> Step 1: Loading data and matching partitions...
Loading raw data from /home/bingxing2/home/scx7l1f/IAP_TSDO.npy...
Base filtering (Year/Depth) remaining: 47075260
Matching points to partition grid (Nearest Neighbor)...

========================================
DATA COUNTS PER PARTITION (Total Points: 47075260)
Partition ID    | Count          
-----------------------------------
1               | 10519270        <--- TARGET
2               | 27228           
3               | 3442432         
4               | 165048          
5               | 4623530         
6               | 311543          
7               | 2243179         
8               | 2988949         
9               | 4488154         
10              | 1945065         
11              | 5384974         
12              | 8383088         
13              | 1442009         
========================================

Selected Partition: 1
Final Training Data Count: 10519270
Split: Tr:7494209, Val:1287832, Te:1737229

>>> Step 2: Training 6 Base Models (OOF + Full)...
   Generating OOF (5 folds)...
     Fold 1/5...
TBB Warning: The number of workers is currently limited to 31. The request for 127 workers is ignored. Further requests for more workers will be silently ignored until the limit changes.

[Parallel(n_jobs=8)]: Using backend ThreadingBackend with 8 concurrent workers.
building tree 1 of 40building tree 2 of 40building tree 3 of 40building tree 4 of 40building tree 5 of 40building tree 6 of 40building tree 7 of 40building tree 8 of 40







building tree 9 of 40
building tree 10 of 40
building tree 11 of 40
building tree 12 of 40
building tree 13 of 40
building tree 14 of 40
building tree 15 of 40
building tree 16 of 40
building tree 17 of 40building tree 18 of 40

building tree 19 of 40
building tree 20 of 40
building tree 21 of 40
building tree 22 of 40
building tree 23 of 40
building tree 24 of 40
building tree 25 of 40
building tree 26 of 40
building tree 27 of 40
building tree 28 of 40
building tree 29 of 40
building tree 30 of 40
building tree 31 of 40
building tree 32 of 40
building tree 33 of 40[Parallel(n_jobs=8)]: Done  25 tasks      | elapsed:   53.7s

building tree 34 of 40
building tree 35 of 40
building tree 36 of 40
building tree 37 of 40
building tree 38 of 40
building tree 39 of 40
building tree 40 of 40
[Parallel(n_jobs=8)]: Done  40 out of  40 | elapsed:  1.2min finished
[Parallel(n_jobs=8)]: Using backend ThreadingBackend with 8 concurrent workers.
[Parallel(n_jobs=8)]: Done  25 tasks      | elapsed:    0.5s
[Parallel(n_jobs=8)]: Done  40 out of  40 | elapsed:    0.7s finished
[Parallel(n_jobs=8)]: Using backend ThreadingBackend with 8 concurrent workers.
building tree 1 of 40building tree 2 of 40building tree 3 of 40building tree 4 of 40building tree 5 of 40building tree 6 of 40building tree 7 of 40
building tree 8 of 40






building tree 9 of 40
building tree 10 of 40
building tree 11 of 40
building tree 12 of 40
building tree 13 of 40
building tree 14 of 40
building tree 15 of 40
building tree 16 of 40
building tree 17 of 40
building tree 18 of 40
building tree 19 of 40
building tree 20 of 40
building tree 21 of 40
building tree 22 of 40
building tree 23 of 40
building tree 24 of 40
building tree 25 of 40
building tree 26 of 40
building tree 27 of 40
building tree 28 of 40
building tree 29 of 40
building tree 30 of 40
building tree 31 of 40
building tree 32 of 40
building tree 33 of 40[Parallel(n_jobs=8)]: Done  25 tasks      | elapsed:   14.7s

building tree 34 of 40
building tree 35 of 40
building tree 36 of 40
building tree 37 of 40
building tree 38 of 40
building tree 39 of 40
building tree 40 of 40
[Parallel(n_jobs=8)]: Done  40 out of  40 | elapsed:   21.2s finished
[Parallel(n_jobs=8)]: Using backend ThreadingBackend with 8 concurrent workers.
[Parallel(n_jobs=8)]: Done  25 tasks      | elapsed:    0.4s
[Parallel(n_jobs=8)]: Done  40 out of  40 | elapsed:    0.6s finished
     Fold 2/5...
[Parallel(n_jobs=8)]: Using backend ThreadingBackend with 8 concurrent workers.
building tree 1 of 40building tree 2 of 40building tree 3 of 40building tree 4 of 40building tree 5 of 40building tree 6 of 40building tree 7 of 40building tree 8 of 40







building tree 9 of 40
building tree 10 of 40
building tree 11 of 40
building tree 12 of 40
building tree 13 of 40
building tree 14 of 40
building tree 15 of 40
building tree 16 of 40
building tree 17 of 40
building tree 18 of 40
building tree 19 of 40
building tree 20 of 40
building tree 21 of 40
building tree 22 of 40
building tree 23 of 40
building tree 24 of 40
building tree 25 of 40
building tree 26 of 40
building tree 27 of 40
building tree 28 of 40
building tree 29 of 40
building tree 30 of 40
building tree 31 of 40
building tree 32 of 40
building tree 33 of 40[Parallel(n_jobs=8)]: Done  25 tasks      | elapsed:   53.8s

building tree 34 of 40
building tree 35 of 40
building tree 36 of 40
building tree 37 of 40
building tree 38 of 40
building tree 39 of 40
building tree 40 of 40
[Parallel(n_jobs=8)]: Done  40 out of  40 | elapsed:  1.2min finished
[Parallel(n_jobs=8)]: Using backend ThreadingBackend with 8 concurrent workers.
[Parallel(n_jobs=8)]: Done  25 tasks      | elapsed:    0.5s
[Parallel(n_jobs=8)]: Done  40 out of  40 | elapsed:    0.7s finished
[Parallel(n_jobs=8)]: Using backend ThreadingBackend with 8 concurrent workers.
building tree 1 of 40building tree 2 of 40building tree 3 of 40building tree 4 of 40building tree 5 of 40building tree 6 of 40building tree 7 of 40building tree 8 of 40







building tree 9 of 40
building tree 10 of 40
building tree 11 of 40
building tree 12 of 40
building tree 13 of 40
building tree 14 of 40
building tree 15 of 40
building tree 16 of 40
building tree 17 of 40
building tree 18 of 40
building tree 19 of 40
building tree 20 of 40
building tree 21 of 40
building tree 22 of 40
building tree 23 of 40
building tree 24 of 40
building tree 25 of 40
building tree 26 of 40
building tree 27 of 40
building tree 28 of 40
building tree 29 of 40
building tree 30 of 40
building tree 31 of 40
building tree 32 of 40
building tree 33 of 40[Parallel(n_jobs=8)]: Done  25 tasks      | elapsed:   14.9s

building tree 34 of 40
building tree 35 of 40
building tree 36 of 40
building tree 37 of 40
building tree 38 of 40
building tree 39 of 40
building tree 40 of 40
[Parallel(n_jobs=8)]: Done  40 out of  40 | elapsed:   21.6s finished
[Parallel(n_jobs=8)]: Using backend ThreadingBackend with 8 concurrent workers.
[Parallel(n_jobs=8)]: Done  25 tasks      | elapsed:    0.4s
[Parallel(n_jobs=8)]: Done  40 out of  40 | elapsed:    0.5s finished
     Fold 3/5...
[Parallel(n_jobs=8)]: Using backend ThreadingBackend with 8 concurrent workers.
building tree 1 of 40building tree 5 of 40building tree 2 of 40building tree 3 of 40building tree 4 of 40building tree 6 of 40
building tree 7 of 40building tree 8 of 40






building tree 9 of 40
building tree 10 of 40
building tree 11 of 40
building tree 12 of 40
building tree 13 of 40
building tree 14 of 40
building tree 15 of 40
building tree 16 of 40
building tree 17 of 40building tree 18 of 40

building tree 19 of 40
building tree 20 of 40building tree 21 of 40

building tree 22 of 40
building tree 23 of 40
building tree 24 of 40
building tree 25 of 40
building tree 26 of 40
building tree 27 of 40
building tree 28 of 40
building tree 29 of 40
building tree 30 of 40
building tree 31 of 40
building tree 32 of 40
building tree 33 of 40[Parallel(n_jobs=8)]: Done  25 tasks      | elapsed:   54.5s

building tree 34 of 40
building tree 35 of 40
building tree 36 of 40
building tree 37 of 40
building tree 38 of 40
building tree 39 of 40
building tree 40 of 40
[Parallel(n_jobs=8)]: Done  40 out of  40 | elapsed:  1.2min finished
[Parallel(n_jobs=8)]: Using backend ThreadingBackend with 8 concurrent workers.
[Parallel(n_jobs=8)]: Done  25 tasks      | elapsed:    0.5s
[Parallel(n_jobs=8)]: Done  40 out of  40 | elapsed:    0.7s finished
[Parallel(n_jobs=8)]: Using backend ThreadingBackend with 8 concurrent workers.
building tree 1 of 40building tree 2 of 40building tree 3 of 40building tree 4 of 40building tree 5 of 40building tree 6 of 40
building tree 7 of 40building tree 8 of 40






building tree 9 of 40
building tree 10 of 40
building tree 11 of 40
building tree 12 of 40
building tree 13 of 40
building tree 14 of 40
building tree 15 of 40
building tree 16 of 40
building tree 17 of 40
building tree 18 of 40
building tree 19 of 40
building tree 20 of 40
building tree 21 of 40
building tree 22 of 40
building tree 23 of 40
building tree 24 of 40
building tree 25 of 40
building tree 26 of 40
building tree 27 of 40
building tree 28 of 40
building tree 29 of 40
building tree 30 of 40
building tree 31 of 40
building tree 32 of 40
building tree 33 of 40[Parallel(n_jobs=8)]: Done  25 tasks      | elapsed:   16.1s

building tree 34 of 40
building tree 35 of 40
building tree 36 of 40
building tree 37 of 40
building tree 38 of 40
building tree 39 of 40
building tree 40 of 40
[Parallel(n_jobs=8)]: Done  40 out of  40 | elapsed:   21.5s finished
[Parallel(n_jobs=8)]: Using backend ThreadingBackend with 8 concurrent workers.
[Parallel(n_jobs=8)]: Done  25 tasks      | elapsed:    0.4s
[Parallel(n_jobs=8)]: Done  40 out of  40 | elapsed:    0.5s finished
     Fold 4/5...
[Parallel(n_jobs=8)]: Using backend ThreadingBackend with 8 concurrent workers.
building tree 1 of 40building tree 2 of 40building tree 3 of 40building tree 4 of 40building tree 5 of 40building tree 6 of 40building tree 7 of 40
building tree 8 of 40






building tree 9 of 40
building tree 10 of 40
building tree 11 of 40
building tree 12 of 40
building tree 13 of 40building tree 14 of 40

building tree 15 of 40
building tree 16 of 40
building tree 17 of 40
building tree 18 of 40
building tree 19 of 40
building tree 20 of 40
building tree 21 of 40
building tree 22 of 40
building tree 23 of 40
building tree 24 of 40
building tree 25 of 40
building tree 26 of 40
building tree 27 of 40
building tree 28 of 40
building tree 29 of 40
building tree 30 of 40
building tree 31 of 40
building tree 32 of 40
building tree 33 of 40[Parallel(n_jobs=8)]: Done  25 tasks      | elapsed:   54.1s

building tree 34 of 40
building tree 35 of 40
building tree 36 of 40
building tree 37 of 40
building tree 38 of 40
building tree 39 of 40
building tree 40 of 40
[Parallel(n_jobs=8)]: Done  40 out of  40 | elapsed:  1.3min finished
[Parallel(n_jobs=8)]: Using backend ThreadingBackend with 8 concurrent workers.
[Parallel(n_jobs=8)]: Done  25 tasks      | elapsed:    0.5s
[Parallel(n_jobs=8)]: Done  40 out of  40 | elapsed:    0.7s finished
[Parallel(n_jobs=8)]: Using backend ThreadingBackend with 8 concurrent workers.
building tree 1 of 40building tree 2 of 40building tree 3 of 40building tree 4 of 40building tree 5 of 40
building tree 6 of 40
building tree 7 of 40building tree 8 of 40





building tree 9 of 40
building tree 10 of 40
building tree 11 of 40
building tree 12 of 40
building tree 13 of 40
building tree 14 of 40
building tree 15 of 40
building tree 16 of 40
building tree 17 of 40
building tree 18 of 40
building tree 19 of 40
building tree 20 of 40
building tree 21 of 40
building tree 22 of 40
building tree 23 of 40
building tree 24 of 40
building tree 25 of 40
building tree 26 of 40
building tree 27 of 40
building tree 28 of 40
building tree 29 of 40
building tree 30 of 40
building tree 31 of 40
building tree 32 of 40
building tree 33 of 40[Parallel(n_jobs=8)]: Done  25 tasks      | elapsed:   14.9s

building tree 34 of 40
building tree 35 of 40
building tree 36 of 40
building tree 37 of 40
building tree 38 of 40
building tree 39 of 40
building tree 40 of 40
[Parallel(n_jobs=8)]: Done  40 out of  40 | elapsed:   21.0s finished
[Parallel(n_jobs=8)]: Using backend ThreadingBackend with 8 concurrent workers.
[Parallel(n_jobs=8)]: Done  25 tasks      | elapsed:    0.4s
[Parallel(n_jobs=8)]: Done  40 out of  40 | elapsed:    0.6s finished
     Fold 5/5...
[Parallel(n_jobs=8)]: Using backend ThreadingBackend with 8 concurrent workers.
building tree 1 of 40building tree 5 of 40building tree 2 of 40building tree 3 of 40building tree 4 of 40building tree 6 of 40
building tree 7 of 40building tree 8 of 40






building tree 9 of 40
building tree 10 of 40
building tree 11 of 40
building tree 12 of 40
building tree 13 of 40
building tree 14 of 40
building tree 15 of 40
building tree 16 of 40
building tree 17 of 40
building tree 18 of 40
building tree 19 of 40
building tree 20 of 40
building tree 21 of 40
building tree 22 of 40
building tree 23 of 40
building tree 24 of 40
building tree 25 of 40
building tree 26 of 40
building tree 27 of 40
building tree 28 of 40
building tree 29 of 40
building tree 30 of 40
building tree 31 of 40
building tree 32 of 40
building tree 33 of 40[Parallel(n_jobs=8)]: Done  25 tasks      | elapsed:   54.1s

building tree 34 of 40
building tree 35 of 40
building tree 36 of 40
building tree 37 of 40
building tree 38 of 40
building tree 39 of 40
building tree 40 of 40
[Parallel(n_jobs=8)]: Done  40 out of  40 | elapsed:  1.2min finished
[Parallel(n_jobs=8)]: Using backend ThreadingBackend with 8 concurrent workers.
[Parallel(n_jobs=8)]: Done  25 tasks      | elapsed:    0.5s
[Parallel(n_jobs=8)]: Done  40 out of  40 | elapsed:    0.7s finished
[Parallel(n_jobs=8)]: Using backend ThreadingBackend with 8 concurrent workers.
building tree 1 of 40building tree 2 of 40building tree 3 of 40building tree 4 of 40building tree 5 of 40building tree 6 of 40building tree 7 of 40building tree 8 of 40







building tree 9 of 40
building tree 10 of 40
building tree 11 of 40
building tree 12 of 40
building tree 13 of 40
building tree 14 of 40
building tree 15 of 40
building tree 16 of 40
building tree 17 of 40
building tree 18 of 40
building tree 19 of 40
building tree 20 of 40
building tree 21 of 40
building tree 22 of 40
building tree 23 of 40
building tree 24 of 40
building tree 25 of 40
building tree 26 of 40
building tree 27 of 40
building tree 28 of 40
building tree 29 of 40
building tree 30 of 40
building tree 31 of 40
building tree 32 of 40
building tree 33 of 40[Parallel(n_jobs=8)]: Done  25 tasks      | elapsed:   15.2s

building tree 34 of 40
building tree 35 of 40
building tree 36 of 40
building tree 37 of 40
building tree 38 of 40
building tree 39 of 40
building tree 40 of 40
[Parallel(n_jobs=8)]: Done  40 out of  40 | elapsed:   20.5s finished
[Parallel(n_jobs=8)]: Using backend ThreadingBackend with 8 concurrent workers.
[Parallel(n_jobs=8)]: Done  25 tasks      | elapsed:    0.4s
[Parallel(n_jobs=8)]: Done  40 out of  40 | elapsed:    0.6s finished
   Training Full Models for Inference & Saving...
     Fitting lgb...
     Fitting rf...
[Parallel(n_jobs=8)]: Using backend ThreadingBackend with 8 concurrent workers.
building tree 1 of 40building tree 2 of 40building tree 3 of 40building tree 4 of 40building tree 5 of 40
building tree 6 of 40building tree 7 of 40building tree 8 of 40






building tree 9 of 40
building tree 10 of 40
building tree 11 of 40
building tree 12 of 40
building tree 13 of 40
building tree 14 of 40
building tree 15 of 40
building tree 16 of 40
building tree 17 of 40
building tree 18 of 40
building tree 19 of 40
building tree 20 of 40
building tree 21 of 40
building tree 22 of 40
building tree 23 of 40
building tree 24 of 40
building tree 25 of 40
building tree 26 of 40
building tree 27 of 40
building tree 28 of 40
building tree 29 of 40
building tree 30 of 40
building tree 31 of 40
building tree 32 of 40
building tree 33 of 40[Parallel(n_jobs=8)]: Done  25 tasks      | elapsed:  1.2min

building tree 34 of 40
building tree 35 of 40
building tree 36 of 40
building tree 37 of 40
building tree 38 of 40
building tree 39 of 40
building tree 40 of 40
[Parallel(n_jobs=8)]: Done  40 out of  40 | elapsed:  1.6min finished
[Parallel(n_jobs=8)]: Using backend ThreadingBackend with 8 concurrent workers.
[Parallel(n_jobs=8)]: Done  25 tasks      | elapsed:    0.4s
[Parallel(n_jobs=8)]: Done  40 out of  40 | elapsed:    0.5s finished
[Parallel(n_jobs=8)]: Using backend ThreadingBackend with 8 concurrent workers.
[Parallel(n_jobs=8)]: Done  25 tasks      | elapsed:    0.5s
[Parallel(n_jobs=8)]: Done  40 out of  40 | elapsed:    0.7s finished
     Fitting cb...
     Fitting xgb...
     Fitting ert...
[Parallel(n_jobs=8)]: Using backend ThreadingBackend with 8 concurrent workers.
building tree 1 of 40building tree 2 of 40
building tree 3 of 40building tree 4 of 40building tree 5 of 40building tree 6 of 40
building tree 7 of 40building tree 8 of 40





building tree 9 of 40
building tree 10 of 40
building tree 11 of 40
building tree 12 of 40
building tree 13 of 40
building tree 14 of 40
building tree 15 of 40
building tree 16 of 40
building tree 17 of 40
building tree 18 of 40
building tree 19 of 40
building tree 20 of 40
building tree 21 of 40
building tree 22 of 40
building tree 23 of 40
building tree 24 of 40
building tree 25 of 40
building tree 26 of 40
building tree 27 of 40
building tree 28 of 40
building tree 29 of 40
building tree 30 of 40
building tree 31 of 40
building tree 32 of 40
building tree 33 of 40[Parallel(n_jobs=8)]: Done  25 tasks      | elapsed:   19.3s

building tree 34 of 40
building tree 35 of 40
building tree 36 of 40
building tree 37 of 40
building tree 38 of 40
building tree 39 of 40
building tree 40 of 40
[Parallel(n_jobs=8)]: Done  40 out of  40 | elapsed:   27.8s finished
[Parallel(n_jobs=8)]: Using backend ThreadingBackend with 8 concurrent workers.
[Parallel(n_jobs=8)]: Done  25 tasks      | elapsed:    0.3s
[Parallel(n_jobs=8)]: Done  40 out of  40 | elapsed:    0.4s finished
[Parallel(n_jobs=8)]: Using backend ThreadingBackend with 8 concurrent workers.
[Parallel(n_jobs=8)]: Done  25 tasks      | elapsed:    0.4s
[Parallel(n_jobs=8)]: Done  40 out of  40 | elapsed:    0.6s finished
     Fitting knn...
   Saving OOF and Base Preds to /home/bingxing2/home/scx7l1f/rec/cluster_partition/partition_1/results/ ...

>>> Step 3: Training Spatial Stacker...
   Stacker Epoch 0: Val Loss 77.3078
   Stacker Epoch 20: Val Loss 76.1677
   Stacker Epoch 40: Val Loss 76.2102
   Stacker Epoch 60: Val Loss 76.2528
   Stacker Epoch 80: Val Loss 76.2710
Stacker (Test) | RMSE: 9.3822 | R2: 0.9830 | MAE: 6.0334 | MB: 0.6703
预测值范围: 3.77 ~ 381.49

>>> Step 4: Training PINN...
   PINN Epoch 0: Val MSE 7746.4706 (Phys W: 0.5)
   PINN Epoch 5: Val MSE 83.5507 (Phys W: 0.6)
   PINN Epoch 10: Val MSE 76.0805 (Phys W: 0.7)
   PINN Epoch 15: Val MSE 81.4260 (Phys W: 0.8)
   PINN Epoch 20: Val MSE 81.1006 (Phys W: 0.9)
   PINN Epoch 25: Val MSE 75.9085 (Phys W: 1.0)
   PINN Epoch 30: Val MSE 78.7900 (Phys W: 1.0)
   PINN Epoch 35: Val MSE 79.4138 (Phys W: 1.0)
   PINN Epoch 40: Val MSE 78.4662 (Phys W: 1.0)
   PINN Epoch 45: Val MSE 78.4438 (Phys W: 1.0)

===== FINAL RESULTS =====
Stacker Only | RMSE: 9.3822 | R2: 0.9830 | MAE: 6.0334 | MB: 0.6703
预测值范围: 3.77 ~ 381.49
PINN (Final) | RMSE: 9.0697 | R2: 0.9842 | MAE: 5.8764 | MB: 0.0221
预测值范围: 10.01 ~ 369.97
Total Time: 239.1 mins
  0%|          | 0/22 [00:00<?, ?it/s]100%|██████████| 22/22 [00:00<00:00, 333.70it/s]



============ Job 1133978 Performance Details ============
JobID: 1133978
User: scx7l1f
Nodes、GPU: paraai-n32-h-01-agent-9: 2
Time Range: 2026-01-29 02:27:41 - 2026-01-29 06:27:10
Running time: 0d3H59M29S
GPU Util: 1.55 %
GMem Util: 7.01 %
GMemBW Util: 0.38 %
Tensor Core Util: 0.01 %
Tensor IMMA Util: N/A
Tensor HMMA Util: N/A
Tensor DFMA Util: N/A
FP64 Util: 0 %
FP32 Util: 0.04 %
FP16 Util: 0 %
GPCIE RX: 3.29 MB/s
GPCIE TX: 850.37 KB/s
GNVLINK: N/A
GPU Power: 42.45 W
GPU Temperature: 32.97 °C

Additional Performance Data:
--- flops performance(avg to single card) ---
|- fp64: 0 TFlops
|- fp32: 0 TFlops
|- fp16: 0 TFlops
|- tensor: 0 TFlops
> |- GMEMBW/F: 641,759 B/MF
> |- NVLINK/F: No Data
> |- IB_TX/F: 880 B/MF
> |- IB_RX/F: 40,695 B/MF
> |- PCIE_TX/F: 87 B/MF
> |- PCIE_RX/F: 343 B/MF
=========================================================
